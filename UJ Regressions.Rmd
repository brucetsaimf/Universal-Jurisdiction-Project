---
title: "UJ Regressions+Plots"
header-includes: \usepackage{dcolumn}
output:
  pdf_document:
    keep_tex: yes
classoption: landscape
---
```{r}
suppressMessages(library(readxl))
suppressMessages(library(igraph))
suppressMessages(library(tidyverse))
suppressMessages(library(dplyr))
suppressMessages(library(ggplot2))
suppressMessages(library(ggraph))
suppressMessages(library(maps))
suppressMessages(library(lubridate))
suppressMessages(library(janitor))
suppressMessages(library(tibble))
suppressMessages(library(haven))
suppressMessages(library(jtools))
suppressMessages(library(huxtable))
suppressMessages(library(devtools))
suppressMessages(library(Zelig))
suppressMessages(library(psych))
suppressMessages(library(Hmisc))
suppressMessages(library(fts))
suppressMessages(library(zoo))
suppressMessages(library(runner))
suppressMessages(library(tibbletime))
suppressMessages(library(stargazer))
suppressMessages(library(dotwhisker))
suppressMessages(library(miceadds))
```

Note: Zelig is unavailable through CRAN. Run devtools::install_github('IQSS/Zelig') to install package.

```{r}
merged_data = read.csv("Full Dataframe.csv")
```

# Regression Preprocessing

```{r}
merged_data$alliance = as.factor(merged_data$alliance)
merged_data$d_colony2 = as.factor(merged_data$d_colony2)
merged_data$langshare = as.factor(merged_data$langshare)
merged_data$romesigned = as.factor(merged_data$romesigned)
merged_data$romeratify = as.factor(merged_data$romeratify)
```

# Replication migrant stocks OLS Regression
```{r}
# Cases

replication_model_caseprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.casecount ~ lwbstocksout_full + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(replication_model_caseprosecuting)

# Trials
replication_model_trialprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.trialcount ~ lwbstocksout_full + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(replication_model_trialprosecuting)
```

# Leblang flows OLS Regression
```{r}
# Cases
leblang_model_caseprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.casecount ~ newflow + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(leblang_model_caseprosecuting)

# Trials
leblang_model_trialprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.trialcount ~ newflow + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(leblang_model_trialprosecuting)
```

# Refugee OLS Regression
```{r}
# No imputation Cases
refugee_ymodel_caseprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.casecount ~ y + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(refugee_ymodel_caseprosecuting)

# No imputation Trials
refugee_ymodel_trialprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.trialcount ~ y + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(refugee_ymodel_trialprosecuting)

# LASSO Cases
refugee_ylassomodel_caseprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.casecount ~ ylasso + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(refugee_ylassomodel_caseprosecuting)

# LASSO Trials
refugee_ylassomodel_trialprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.trialcount ~ ylasso + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(refugee_ylassomodel_trialprosecuting)

# Ylinpol Cases
refugee_ylinpolmodel_caseprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.casecount ~ ylinpol + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(refugee_ylinpolmodel_caseprosecuting)

# Ylinpol Trials
refugee_ylinpolmodel_trialprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.trialcount ~ ylinpol + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(refugee_ylinpolmodel_trialprosecuting)
```

# Demig COB OLS Regression
```{r}
# Cases
demigcob_model_caseprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.casecount ~ COB.Flow + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")
summary(demigcob_model_caseprosecuting)
```

# Demig COR OLS Regression
```{r}
# Cases
demigcor_model_caseprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.casecount ~ COR.Flow + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(demigcor_model_caseprosecuting)
```

# Demig COC OLS Regression
```{r}
# Cases
demigcoc_model_caseprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.casecount ~ COC.Flow + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(demigcoc_model_caseprosecuting)
```

# RE Logit Preprocessing

```{r}
merged_data_firstcases = merged_data[!(is.na(merged_data$First.Case)),]
merged_data_firstcases = merged_data_firstcases[merged_data_firstcases$First.Case >= merged_data_firstcases$year,]
merged_data_firstcases$yrsince1957 = ifelse(merged_data_firstcases$year > 1957, merged_data_firstcases$year - 1957, 0)
merged_data_firstcases$yrsince1957_2 = merged_data_firstcases$yrsince1957^2
merged_data_firstcases$yrsince1957_3 = merged_data_firstcases$yrsince1957^3

merged_data_firsttrials = merged_data[!(is.na(merged_data$First.Trial)),]
merged_data_firsttrials = merged_data_firsttrials[merged_data_firsttrials$First.Trial >= merged_data_firsttrials$year,]
merged_data_firsttrials$yrsince1957 = ifelse(merged_data_firsttrials$year > 1957, merged_data_firsttrials$year - 1957, 0)
merged_data_firsttrials$yrsince1957_2 = merged_data_firsttrials$yrsince1957^2
merged_data_firsttrials$yrsince1957_3 = merged_data_firsttrials$yrsince1957^3
```


# RE Logit

```{r}
replicationcase_relogit = miceadds::glm.cluster(data = merged_data_firstcases, formula = anyprosecutingcase ~ lwbstocksout_full + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2  + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned, cluster="dyad", family="binomial")

replicationtrial_relogit = miceadds::glm.cluster(data = merged_data_firsttrials, formula = anyprosecutingtrial ~ lwbstocksout_full + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2  + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned, cluster="dyad", family="binomial")

summary(replicationcase_relogit)
summary(replicationtrial_relogit)
```

# Leblang Lagged OLS Regressions

```{r}
# Cases
leblanglag_model_caseprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.casecount ~ leblang5y + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(leblanglag_model_caseprosecuting)

# Trials
leblanglag_model_trialprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.trialcount ~ leblang5y + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(leblanglag_model_trialprosecuting)
```

# Demig COR Lagged OLS Regression
```{r}
# Cases
demigcor_laggedmodel_caseprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.casecount ~ cor5y + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(demigcor_laggedmodel_caseprosecuting)

# Trials
demigcor_laggedmodel_trialprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.trialcount ~ cor5y + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(demigcor_laggedmodel_trialprosecuting)
```

# Demig COB Lagged OLS Regression
```{r}
# Cases
demigcob_laggedmodel_caseprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.casecount ~ cob5y + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(demigcob_laggedmodel_caseprosecuting)
```

# Demig COC Lagged OLS Regression
```{r}
# Cases
demigcoc_laggedmodel_caseprosecuting = miceadds::lm.cluster(data = merged_data, formula = prosecuting.casecount ~ coc5y + polity_s_1 + polity_s_2 + violence_domestic_2 + lpop_1 + lpop_2 + lgdpcap_1 + lgdpcap_2 + imports1000 + exports1000 + alliance + ldist2 + d_colony2 + langshare + year + romesigned + romeratify, cluster="dyad")

summary(demigcoc_laggedmodel_caseprosecuting)
```

# Stargazer Plot

```{r latexregtable, results = "asis"}
stargazer(replication_model_caseprosecuting, replication_model_trialprosecuting, title="Replication OLS Results", from_zelig_model(replicationcase_relogit), from_zelig_model(replicationtrial_relogit), single.row = T,
          dep.var.labels = c("Cases (count)","Trials (count)", "Cases (first)", "Trials (first)"), covariate.labels=c("Migrants stock (log)","Polity (RS)", "Polity (SS)","Violence (SS)","Population (log, RS)","Population (log, SS)", "GDPpc (log, RS)", "GDPpc (log, SS)", "Imports", "Exports", "Alliance", "Distance (log)", "Colony", "Shared Language",  "Year", "Rome (signed)", "Rome (ratified)"), order=c("lwbstocksout_full", "polity_s_1", "factor(romesigned)", "factor(romeratify)", "imports1000", "exports1000", "factor(alliance)"))
```

# Coefficient Processing

## Individual Cases Model Coefficient Tables

```{r, echo = FALSE}
# Replication OLS

replication_model_caseprosecuting_table = as.data.frame(summary(replication_model_caseprosecuting)[,c(1,2,4)])
replication_model_caseprosecuting_table$stars = "." 

for(i in 1:nrow(replication_model_caseprosecuting_table)){
  if(replication_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    replication_model_caseprosecuting_table$stars[i] = "***"
  } else if (replication_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    replication_model_caseprosecuting_table$stars[i] = "**"
  } else if (replication_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    replication_model_caseprosecuting_table$stars[i] = "*"
  } else {
    replication_model_caseprosecuting_table$stars[i] = " "
  }
}

# Replication Logit

replicationcase_relogit_table = as.data.frame(summary(replicationcase_relogit)[,c(1,2,4)])
replicationcase_relogit_table$stars = "." 

for(i in 1:nrow(replicationcase_relogit_table)){
  if(replicationcase_relogit_table$`Pr(>|z|)`[i] < 0.01){
    replicationcase_relogit_table$stars[i] = "***"
  } else if (replicationcase_relogit_table$`Pr(>|z|)`[i] < 0.05){
    replicationcase_relogit_table$stars[i] = "**"
  } else if (replicationcase_relogit_table$`Pr(>|z|)`[i] < 0.1){
    replicationcase_relogit_table$stars[i] = "*"
  } else {
    replicationcase_relogit_table$stars[i] = " "
  }
}

# Leblang OLS

leblang_model_caseprosecuting_table = as.data.frame(summary(leblang_model_caseprosecuting)[,c(1,2,4)])
leblang_model_caseprosecuting_table$stars = "." 

for(i in 1:nrow(leblang_model_caseprosecuting_table)){
  if(leblang_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    leblang_model_caseprosecuting_table$stars[i] = "***"
  } else if (leblang_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    leblang_model_caseprosecuting_table$stars[i] = "**"
  } else if (leblang_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    leblang_model_caseprosecuting_table$stars[i] = "*"
  } else {
    leblang_model_caseprosecuting_table$stars[i] = " "
  }
}

# Leblang 5 Year Lag OLS

leblanglag_model_caseprosecuting_table = as.data.frame(summary(leblanglag_model_caseprosecuting)[,c(1,2,4)])
leblanglag_model_caseprosecuting_table$stars = "." 

for(i in 1:nrow(leblanglag_model_caseprosecuting_table)){
  if(leblanglag_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    leblanglag_model_caseprosecuting_table$stars[i] = "***"
  } else if (leblanglag_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    leblanglag_model_caseprosecuting_table$stars[i] = "**"
  } else if (leblanglag_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    leblanglag_model_caseprosecuting_table$stars[i] = "*"
  } else {
    leblanglag_model_caseprosecuting_table$stars[i] = " "
  }
}

# Refugee No Imputation OLS

refugee_ymodel_caseprosecuting_table = as.data.frame(summary(refugee_ymodel_caseprosecuting)[,c(1,2,4)])
refugee_ymodel_caseprosecuting_table$stars = "." 

for(i in 1:nrow(refugee_ymodel_caseprosecuting_table)){
  if(refugee_ymodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    refugee_ymodel_caseprosecuting_table$stars[i] = "***"
  } else if (refugee_ymodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    refugee_ymodel_caseprosecuting_table$stars[i] = "**"
  } else if (refugee_ymodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    refugee_ymodel_caseprosecuting_table$stars[i] = "*"
  } else {
    refugee_ymodel_caseprosecuting_table$stars[i] = " "
  }
}

# Refugee Imputation 1 OLS

refugee_ylassomodel_caseprosecuting_table = as.data.frame(summary(refugee_ylassomodel_caseprosecuting)[,c(1,2,4)])
refugee_ylassomodel_caseprosecuting_table$stars = "." 

for(i in 1:nrow(refugee_ylassomodel_caseprosecuting_table)){
  if(refugee_ylassomodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    refugee_ylassomodel_caseprosecuting_table$stars[i] = "***"
  } else if (refugee_ylassomodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    refugee_ylassomodel_caseprosecuting_table$stars[i] = "**"
  } else if (refugee_ylassomodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    refugee_ylassomodel_caseprosecuting_table$stars[i] = "*"
  } else {
    refugee_ylassomodel_caseprosecuting_table$stars[i] = " "
  }
}

# Refugee Imputation 2 OLS

refugee_ylinpolmodel_caseprosecuting_table = as.data.frame(summary(refugee_ylinpolmodel_caseprosecuting)[,c(1,2,4)])
refugee_ylinpolmodel_caseprosecuting_table$stars = "." 

for(i in 1:nrow(refugee_ylinpolmodel_caseprosecuting_table)){
  if(refugee_ylinpolmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    refugee_ylinpolmodel_caseprosecuting_table$stars[i] = "***"
  } else if (refugee_ylinpolmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    refugee_ylinpolmodel_caseprosecuting_table$stars[i] = "**"
  } else if (refugee_ylinpolmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    refugee_ylinpolmodel_caseprosecuting_table$stars[i] = "*"
  } else {
    refugee_ylinpolmodel_caseprosecuting_table$stars[i] = " "
  }
}

# Refugee Imputation 2 OLS

refugee_ylinpolmodel_caseprosecuting_table = as.data.frame(summary(refugee_ylinpolmodel_caseprosecuting)[,c(1,2,4)])
refugee_ylinpolmodel_caseprosecuting_table$stars = "." 

for(i in 1:nrow(refugee_ylinpolmodel_caseprosecuting_table)){
  if(refugee_ylinpolmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    refugee_ylinpolmodel_caseprosecuting_table$stars[i] = "***"
  } else if (refugee_ylinpolmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    refugee_ylinpolmodel_caseprosecuting_table$stars[i] = "**"
  } else if (refugee_ylinpolmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    refugee_ylinpolmodel_caseprosecuting_table$stars[i] = "*"
  } else {
    refugee_ylinpolmodel_caseprosecuting_table$stars[i] = " "
  }
}

# DEMIG COR OLS

demigcor_model_caseprosecuting_table = as.data.frame(summary(demigcor_model_caseprosecuting)[,c(1,2,4)])
demigcor_model_caseprosecuting_table$stars = "." 

for(i in 1:nrow(demigcor_model_caseprosecuting_table)){
  if(demigcor_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    demigcor_model_caseprosecuting_table$stars[i] = "***"
  } else if (demigcor_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    demigcor_model_caseprosecuting_table$stars[i] = "**"
  } else if (demigcor_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    demigcor_model_caseprosecuting_table$stars[i] = "*"
  } else {
    demigcor_model_caseprosecuting_table$stars[i] = " "
  }
}

# DEMIG COR 5 Year Lagged OLS

demigcor_laggedmodel_caseprosecuting_table = as.data.frame(summary(demigcor_laggedmodel_caseprosecuting)[,c(1,2,4)])
demigcor_laggedmodel_caseprosecuting_table$stars = "." 

for(i in 1:nrow(demigcor_laggedmodel_caseprosecuting_table)){
  if(demigcor_laggedmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    demigcor_laggedmodel_caseprosecuting_table$stars[i] = "***"
  } else if (demigcor_laggedmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    demigcor_laggedmodel_caseprosecuting_table$stars[i] = "**"
  } else if (demigcor_laggedmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    demigcor_laggedmodel_caseprosecuting_table$stars[i] = "*"
  } else {
    demigcor_laggedmodel_caseprosecuting_table$stars[i] = " "
  }
}

# DEMIG COB OLS

demigcob_model_caseprosecuting_table = as.data.frame(summary(demigcob_model_caseprosecuting)[,c(1,2,4)])
demigcob_model_caseprosecuting_table$stars = "." 

for(i in 1:nrow(demigcob_model_caseprosecuting_table)){
  if(demigcob_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    demigcob_model_caseprosecuting_table$stars[i] = "***"
  } else if (demigcob_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    demigcob_model_caseprosecuting_table$stars[i] = "**"
  } else if (demigcob_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    demigcob_model_caseprosecuting_table$stars[i] = "*"
  } else {
    demigcob_model_caseprosecuting_table$stars[i] = " "
  }
}

# DEMIG COB 5 Year Lagged OLS

demigcob_laggedmodel_caseprosecuting_table = as.data.frame(summary(demigcob_laggedmodel_caseprosecuting)[,c(1,2,4)])
demigcob_laggedmodel_caseprosecuting_table$stars = "." 

for(i in 1:nrow(demigcob_laggedmodel_caseprosecuting_table)){
  if(demigcob_laggedmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    demigcob_laggedmodel_caseprosecuting_table$stars[i] = "***"
  } else if (demigcob_laggedmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    demigcob_laggedmodel_caseprosecuting_table$stars[i] = "**"
  } else if (demigcob_laggedmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    demigcob_laggedmodel_caseprosecuting_table$stars[i] = "*"
  } else {
    demigcob_laggedmodel_caseprosecuting_table$stars[i] = " "
  }
}

# DEMIG COC OLS

demigcoc_model_caseprosecuting_table = as.data.frame(summary(demigcoc_model_caseprosecuting)[,c(1,2,4)])
demigcoc_model_caseprosecuting_table$stars = "." 

for(i in 1:nrow(demigcoc_model_caseprosecuting_table)){
  if(demigcoc_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    demigcoc_model_caseprosecuting_table$stars[i] = "***"
  } else if (demigcoc_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    demigcoc_model_caseprosecuting_table$stars[i] = "**"
  } else if (demigcoc_model_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    demigcoc_model_caseprosecuting_table$stars[i] = "*"
  } else {
    demigcoc_model_caseprosecuting_table$stars[i] = " "
  }
}

# DEMIG COC 5 Year Lagged OLS

demigcoc_laggedmodel_caseprosecuting_table = as.data.frame(summary(demigcoc_laggedmodel_caseprosecuting)[,c(1,2,4)])
demigcoc_laggedmodel_caseprosecuting_table$stars = "." 

for(i in 1:nrow(demigcoc_laggedmodel_caseprosecuting_table)){
  if(demigcoc_laggedmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.01){
    demigcoc_laggedmodel_caseprosecuting_table$stars[i] = "***"
  } else if (demigcoc_laggedmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.05){
    demigcoc_laggedmodel_caseprosecuting_table$stars[i] = "**"
  } else if (demigcoc_laggedmodel_caseprosecuting_table$`Pr(>|t|)`[i] < 0.1){
    demigcoc_laggedmodel_caseprosecuting_table$stars[i] = "*"
  } else {
    demigcoc_laggedmodel_caseprosecuting_table$stars[i] = " "
  }
}
```

## Cases Dwplot

```{r}
coeffplot = 
rbind(
 replication_model_caseprosecuting_table[2,c(1,2)],
 replicationcase_relogit_table[2,c(1,2)],
 leblang_model_caseprosecuting_table[2,c(1,2)],
 leblanglag_model_caseprosecuting_table[2,c(1,2)],
 refugee_ymodel_caseprosecuting_table[2,c(1,2)],
 refugee_ylassomodel_caseprosecuting_table[2,c(1,2)],
 refugee_ylinpolmodel_caseprosecuting_table[2,c(1,2)],
 demigcor_model_caseprosecuting_table[2,c(1,2)],
 demigcor_laggedmodel_caseprosecuting_table[2,c(1,2)],
 demigcob_model_caseprosecuting_table[2,c(1,2)],
 demigcob_laggedmodel_caseprosecuting_table[2,c(1,2)],
 demigcoc_model_caseprosecuting_table[2,c(1,2)],
 demigcoc_laggedmodel_caseprosecuting_table[2,c(1,2)])

colnames(coeffplot) = c("estimate","std.error")
coeffplot$term =  c("World Bank OLS", "World Bank Relogit", "Leblang OLS", "Leblang 5 Year Lag OLS", "Refugee No Imputation OLS", "Refugee Imputation 1 OLS", "Refugee Imputation 2 OLS", "DEMIG COR OLS", "DEMIG COR 5 Year OLS", "DEMIG COB OLS", "DEMIG COB 5 Year OLS", "DEMIG COC OLS", "DEMIG COC 5 Year OLS")

m1_df = tibble(coeffplot)
m1_df
dwplot(m1_df) +
  labs(title = "Immigration Variable Coefficient across Case Count Regressions")
```

